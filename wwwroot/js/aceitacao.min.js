const Status=Object.freeze({Aceitar:{cod:4,desc:"Aguardando Proposta"},Recusar:{cod:14,desc:"Cotação Recusada"},Repicar:{cod:15,desc:"Repique Cotação"}});window.AceitacaoUI={initialize:function(n){n&&n()},habilitaDesabilitaStatusAceitacao:function(){cotacao.Status.Codigo==3?$("#selectStatusAceitacaoOrcamento").prop("disabled",!1):$("#selectStatusAceitacaoOrcamento").prop("disabled",!0)},showHideMotivoStatus:function(){$("#selectStatusAceitacaoOrcamento").val()=="1"?$("#divMotivoAceitacaoOrcamento").hide():$("#divMotivoAceitacaoOrcamento").show()},alterarStatusAceitacao:function(n){$("#divMotivoAceitacaoOrcamento").show();n.codigoStatus==Status.Recusar.cod?$("#selectStatusAceitacaoOrcamento").val(2):n.codigoStatus==Status.Repicar.cod?$("#selectStatusAceitacaoOrcamento").val(3):($("#selectStatusAceitacaoOrcamento").val(1),$("#divMotivoAceitacaoOrcamento").hide());$("#selectStatusAceitacaoOrcamento").change();$("#txtMotivoOrcamentoAceitacao").val(n.descricaoMotivoStatus)}};window.AceitacaoFunctions={initialize:function(n){window.AceitacaoFunctions.obterUltimoStatusCotacao();n&&n()},obterUltimoStatusCotacao:function(n){$.ajax({url:"/cotacao/ObterStatus",type:"post",contentType:"application/json",success:function(t){closeModalWait();window.AceitacaoUI.alterarStatusAceitacao(t[0]);n&&n()},error:function(n){var i,t;for(closeModalWait(),i=JSON.parse(n.responseText),t=0;t<i.length;t++)notification("erro",i[t],"")},data:JSON.stringify({NumeroCotacao:cotacao._id,CodigoStatus:null,UltimoStatus:!0})})},alterarStatusOrcamentoAceitacao:function(n,t){$.ajax({url:"/cotacao/AlterarStatus",type:"post",contentType:"application/json",success:function(){t.cod==Status.Aceitar.cod?notification("sucesso","Orçamento aceito com sucesso!",""):t.cod==Status.Recusar.cod?notification("sucesso","Orçamento recusado com sucesso!",""):t.cod==Status.Repicar.cod&&notification("sucesso","Repique solicitado com sucesso!","");$("#statusCotacao").text("STATUS:"+t.desc);cotacao.Status={Codigo:t.cod,Descricao:t.desc};window.ControleDeAcessoCotacaoFunctions.ValidaExibicaoDasAbas();window.ControleDeAcessoCotacaoFunctions.ValidaExibicaoDasSessoes();n&&n()},error:function(n){for(var i=JSON.parse(n.responseText),t=0;t<i.length;t++)notification("erro",i[t],"")},data:JSON.stringify({NumeroCotacao:cotacao._id,CodigoStatus:t.cod,DescricaoStatus:t.desc,Data:new Date,DescricaoMotivoStatus:$("#txtMotivoOrcamentoAceitacao").val()})})},aceitar:function(){confirm("Deseja Aceitar o Orçamento?Sim/Não")&&window.AceitacaoFunctions.alterarStatusOrcamentoAceitacao(function(){},Status.Aceitar)},recusar:function(){confirm("Deseja Recusar o Orçamento?Sim/Não")&&window.AceitacaoFunctions.alterarStatusOrcamentoAceitacao(function(){},Status.Recusar)},repicar:function(){confirm("Deseja solicitar repique do Orçamento?Sim/Não")&&window.AceitacaoFunctions.alterarStatusOrcamentoAceitacao(function(){},Status.Repicar)},validaMotivoOrcamento:function(n){if($("#selectStatusAceitacaoOrcamento").val()!="1"&&$("#txtMotivoOrcamentoAceitacao").val()==""){$("#txtMotivoOrcamentoAceitacao").addClass("input-validation-error");notification("erro","O campo de Motivo deve ser preenchido.","txtMotivoOrcamentoAceitacao");return}n&&n()}};window.AceitacaoEvents={onClickSalvarAceitacao:function(){window.AceitacaoFunctions.validaMotivoOrcamento(function(){let n=$("#selectStatusAceitacaoOrcamento").val();n=="1"?window.AceitacaoFunctions.aceitar():n=="2"?window.AceitacaoFunctions.recusar():n=="3"&&window.AceitacaoFunctions.repicar()})},onChangeSelectStatusAceitacaoOrcamento:function(){$("#txtMotivoOrcamentoAceitacao").val("");window.AceitacaoUI.showHideMotivoStatus()}};