const StatusCO=Object.freeze({Aceitar:{cod:7,desc:"Proposta Aprovada"},Recusar:{cod:17,desc:"Proposta Recusada"},Repicar:{cod:18,desc:"Repique Proposta"}});window.AceitacaoCOUI={initialize:function(n){n&&n()},habilitaDesabilitaStatusAceitacaoCO:function(){cotacao.StatusCO.Codigo==5?$("#selectStatusAceitacaoCO").prop("disabled",!1):$("#selectStatusAceitacaoCO").prop("disabled",!0)},showHideMotivoStatus:function(){$("#selectStatusAceitacaoCO").val()=="1"?$("#divMotivoAceitacaoCO").hide():$("#divMotivoAceitacaoCO").show()},alterarStatusAceitacaoCO:function(n){$("#divMotivoAceitacaoCO").show();n.codigoStatus==StatusCO.Recusar.cod?$("#selectStatusAceitacaoCO").val(2):n.codigoStatus==StatusCO.Repicar.cod?$("#selectStatusAceitacaoCO").val(3):($("#selectStatusAceitacaoCO").val(1),$("#divMotivoAceitacaoCO").hide());$("#selectStatusAceitacaoCO").change();$("#txtMotivoAceitacaoCO").val(n.descricaoMotivoStatus)}};window.AceitacaoCOFunctions={initialize:function(n){window.AceitacaoCOFunctions.obterUltimoStatusCotacao();n&&n()},obterUltimoStatusCotacao:function(n){$.ajax({url:"/cotacao/ObterStatus",type:"post",contentType:"application/json",success:function(t){closeModalWait();window.AceitacaoCOUI.alterarStatusAceitacaoCO(t[0]);n&&n()},error:function(n){var i,t;for(closeModalWait(),i=JSON.parse(n.responseText),t=0;t<i.length;t++)notification("erro",i[t],"")},data:JSON.stringify({NumeroCotacao:cotacao._id,CodigoStatus:null,UltimoStatus:!0})})},alterarStatusAceitacaoCO:function(n,t){$.ajax({url:"/cotacao/AlterarStatus",type:"post",contentType:"application/json",success:function(){t.cod==StatusCO.Aceitar.cod?notification("sucesso","Carta Oferta aceita com sucesso!",""):t.cod==StatusCO.Recusar.cod?notification("sucesso","Carta Oferta recusada!",""):t.cod==StatusCO.Repicar.cod&&notification("sucesso","Repique solicitado com sucesso!","");$("#statusCotacao").text("STATUS:"+t.desc);cotacao.Status={Codigo:t.cod,Descricao:t.desc};window.ControleDeAcessoCotacaoFunctions.ValidaExibicaoDasAbas();window.ControleDeAcessoCotacaoFunctions.ValidaExibicaoDasSessoes();window.CotacaoFunctions.atualizarObjetoCotacao();n&&n()},error:function(n){for(var i=JSON.parse(n.responseText),t=0;t<i.length;t++)notification("erro",i[t],"")},data:JSON.stringify({NumeroCotacao:cotacao._id,CodigoStatus:t.cod,DescricaoStatus:t.desc,Data:new Date,DescricaoMotivoStatus:$("#txtMotivoAceitacaoCO").val()})})},aceitar:function(){confirm("Deseja Aceitar a Carta Oferta?")&&window.AceitacaoCOFunctions.alterarStatusAceitacaoCO(function(){},StatusCO.Aceitar)},recusar:function(){confirm("Deseja Recusar a Carta Oferta?")&&window.AceitacaoCOFunctions.alterarStatusAceitacaoCO(function(){},StatusCO.Recusar)},repicar:function(){confirm("Deseja solicitar repique da Proposta?")&&window.AceitacaoCOFunctions.alterarStatusAceitacaoCO(function(){},StatusCO.Repicar)},validaMotivo:function(n){if($("#selectStatusAceitacaoCO").val()!="1"&&$("#txtMotivoAceitacaoCO").val()==""){$("#txtMotivoAceitacaoCO").addClass("input-validation-error");notification("erro","Campo Motivo é de prenchimento obrigatório","txtMotivoAceitacaoCO");return}n&&n()}};window.AceitacaoCOEvents={onClickSalvarAceitacaoCO:function(){window.AceitacaoCOFunctions.validaMotivo(function(){let n=$("#selectStatusAceitacaoCO").val();n=="1"?window.AceitacaoCOFunctions.aceitar():n=="2"?window.AceitacaoCOFunctions.recusar():n=="3"&&window.AceitacaoCOFunctions.repicar()})},onChangeSelectStatusAceitacaoCO:function(){$("#txtMotivoAceitacaoCO").val("");window.AceitacaoCOUI.showHideMotivoStatus()}};